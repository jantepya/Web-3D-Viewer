(this.webpackJsonpcloud3d=this.webpackJsonpcloud3d||[]).push([[0],{36:function(e,t,n){},37:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var r=n(7),s=n(8),o=n.n(s),c=n(23),a=n.n(c),i=(n(36),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),s(e),o(e),c(e)}))}),d=n(44),l=n(45),u=(n(37),function(){return Object(r.jsx)("div",{children:Object(r.jsx)(d.a,{expand:"md",children:Object(r.jsx)(l.a,{children:"Cloud3D"})})})}),h=n(10),f=n(16),j=n(1),b=n(4),m=n(2),v=n(3),p=n(0),O={drc:0,ply:1,stl:2,gltf:3},g=11184810,w=n(24),y=n(46),x=(n(40),function(e){return Object(r.jsx)("option",{className:"sceneListItem",value:e.uuid,children:e.name})}),L=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){var e;return Object(j.a)(this,n),(e=t.call(this)).removeObjectsFromScene=function(t){var n,r=Object(f.a)(e.state.sceneObjects),s=Object(h.a)(t);try{var o=function(){var e=n.value;-1!==(c=r.findIndex((function(t){return t.uuid===e})))&&r.splice(c,1)};for(s.s();!(n=s.n()).done;){var c;o()}}catch(a){s.e(a)}finally{s.f()}e.setState({sceneObjects:r}),e.props.onItemsRemoved&&e.props.onItemsRemoved(t)},e.addToSceneList=function(t){e.setState((function(e){return{sceneObjects:[].concat(Object(f.a)(e.sceneObjects),[t])}}))},e.onSelectionChanged=function(t){e.props.onSelectionChanged&&e.props.onSelectionChanged(t)},e.onDeleteButtonClicked=function(){if(e.sceneList.current&&e.sceneList.current.selectedOptions){var t,n=[],r=Object(h.a)(e.sceneList.current.selectedOptions);try{for(r.s();!(t=r.n()).done;){var s=t.value;n.push(s.value)}}catch(o){r.e(o)}finally{r.f()}e.removeObjectsFromScene(n)}},e.onUploadButtonClicked=function(){var t=document.createElement("input");t.type="file",t.onchange=e.props.onFileSelected,t.click()},e.render=function(){return Object(r.jsxs)("div",{className:"sidebar",children:[Object(r.jsx)(y.a,{color:"primary",onClick:this.onUploadButtonClicked,children:"+"}),Object(r.jsx)(y.a,{color:"danger",onClick:this.onDeleteButtonClicked,children:"-"}),Object(r.jsx)("form",{children:Object(r.jsxs)("select",{multiple:"multiple",ref:this.sceneList,onChange:this.onSelectionChanged,children:[" ",this.state.sceneObjects.map((function(e){return Object(r.jsx)(x,Object(w.a)({},e),e.uuid)}))]})})]})},e.sceneList=o.a.createRef(),e.state={sceneObjects:[]},e}return n}(o.a.Component),C=n(18),S=n.n(C),k=n(22),R=n(25),E=n(26),F=n(27),P=n(28),B=function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length)||e;return O[t]},D=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){return t(r.result)},r.onerror=n,r.readAsDataURL(e)}))},U=function(){this.loaders={};var e=new R.a;e.setDecoderConfig({type:"wasm"}),e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.4.1/"),e.preload(),this.loaders[O.drc]=e;var t=new E.a;this.loaders[O.ply]=t;var n=new F.a;this.loaders[O.stl]=n;var r=new P.a;r.setDRACOLoader(e),this.loaders[3]=r,this.onLoad=null,this.onProgress=null,this.onError=null};U.prototype.Load=function(e,t){var n=this;return new Promise((function(r,s){e.load(t,(function(e){return r(e)}),n.onProgress,s)}))},U.prototype.LoadURL=function(){var e=Object(k.a)(S.a.mark((function e(t,n){var r,s,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=B(n||t),!(s=this.loaders[r])){e.next=15;break}return e.prev=3,e.next=6,this.Load(s,t);case 6:(o=e.sent)&&this.onLoad(o,n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.onError(e.t0);case 13:e.next=16;break;case 15:this.onError&&this.onError("No loaders found for this file");case 16:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),U.prototype.LoadFile=function(){var e=Object(k.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}return e.prev=1,e.next=4,D(t);case 4:n=e.sent,this.LoadURL(n,t.name),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.onError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();var I=U,z=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){return Object(j.a)(this,n),t.apply(this,arguments)}return n}(n(29).a),W="selectionChanged",M=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var r;Object(j.a)(this,n),(r=t.call(this)).onClick=function(e){e.preventDefault();var t=new p.pb,n=r.renderer.domElement.getBoundingClientRect();t.x=(e.clientX-n.left)/(n.right-n.left)*2-1,t.y=-(e.clientY-n.top)/(n.bottom-n.top)*2+1;var s=new p.cb;s.setFromCamera(t,r.camera);var o=s.intersectObjects(r.meshRoot.children),c=o.length>0?[o[0].object.uuid]:[];r.dispatchEvent({type:W,selection:c})},r.removeObjectsByUUID=function(e){var t,n=Object(h.a)(e);try{for(n.s();!(t=n.n()).done;){var s=t.value,o=r.scene.getObjectByProperty("uuid",s);o&&(o.geometry.dispose(),o.material.dispose(),r.meshRoot.remove(o))}}catch(c){n.e(c)}finally{n.f()}},r.setColorOfObjects=function(e,t){var n,s=Object(h.a)(e);try{for(s.s();!(n=s.n()).done;){var o=n.value,c=r.scene.getObjectByProperty("uuid",o);c&&c.material&&c.material.color.setHex(t)}}catch(a){s.e(a)}finally{s.f()}},r.animate=function(){r.render(),requestAnimationFrame(r.animate)},r.renderer=new p.sb({alpha:!0}),r.renderer.setPixelRatio(window.devicePixelRatio),e.appendChild(r.renderer.domElement),r.camera=new p.U(75,window.innerWidth/window.innerHeight,.001,5e3),r.camera.position.set(0,0,5),r.controls=new z(r.camera,r.renderer.domElement);var s=new p.j(16777215,1);return s.position.set=r.camera.position,r.camera.add(s),r.meshRoot=new p.a(3355443),r.scene=new p.eb,r.scene.add(r.camera),r.scene.add(r.meshRoot),r.renderer.domElement.addEventListener("click",r.onClick,!1),r.resize(r.renderer.domElement.clientWidth,r.renderer.domElement.clientHeight),r.animate(),r}return Object(b.a)(n,[{key:"resize",value:function(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}}]),n}(p.l),N=(n(42),0),T=1,A=2,H=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){var e;return Object(j.a)(this,n),(e=t.call(this)).addMeshToScene=function(t,n){console.log(n+" loaded!");var r=new p.M({color:g,flatShading:!0}),s=new p.J(t,r);s.name=n,e.scene.meshRoot.add(s),e.sideBar.current.addToSceneList(s),e.setState((function(e){return{visibleObjects:[].concat(Object(f.a)(e.visibleObjects),[s]),status:{type:N,message:"Loaded: "+n}}}))},e.onLoadError=function(t){console.log(t),e.setState({status:{type:A,message:"An error occurred..."}})},e.onLoadProgress=function(e){console.log(e.loaded/e.total*100+"% loaded")},e.onObjectsRemoved=function(t){e.scene.removeObjectsByUUID(t)},e.setObjectsSelected=function(t){var n,r=Object(f.a)(e.state.selectedObjects),s=[],o=[],c=Object(h.a)(t);try{for(c.s();!(n=c.n()).done;){var a=n.value;r.includes(a)||s.push(a)}}catch(u){c.e(u)}finally{c.f()}var i,d=Object(h.a)(r);try{for(d.s();!(i=d.n()).done;){var l=i.value;t.includes(l)||o.push(l)}}catch(u){d.e(u)}finally{d.f()}e.setState({selectedObjects:t}),e.scene.setColorOfObjects(o,g),e.scene.setColorOfObjects(s,16774912)},e.onSelectionChanged=function(t){var n,r=[],s=Object(h.a)(t.target.selectedOptions);try{for(s.s();!(n=s.n()).done;){var o=n.value;o&&r.push(o.value)}}catch(c){s.e(c)}finally{s.f()}e.setObjectsSelected(r)},e.onWindowResize=function(){if(e.mount){var t=e.mount.clientWidth,n=e.mount.clientHeight;e.scene.resize(t,n)}},e.onFileSelectedForUpload=function(t){var n=t.target.files[0];e.meshLoader.LoadFile(n),e.setState({status:{type:T,message:"Loading..."}})},e.render=function(){var e,t=this;return Object(r.jsxs)("div",{className:"viewer",children:[Object(r.jsx)(L,{ref:this.sideBar,onFileSelected:this.onFileSelectedForUpload,onItemsRemoved:this.onObjectsRemoved,onSelectionChanged:this.onSelectionChanged}),Object(r.jsx)("div",{className:"window-3d noselect",ref:function(e){t.mount=e},children:(null===(e=this.state.status)||void 0===e?void 0:e.message)&&Object(r.jsxs)("div",{className:"status",children:[this.state.status.type===T&&Object(r.jsx)("img",{src:"/Web-3D-Viewer/spinner.gif",alt:"o",width:"40px"}),this.state.status.type===A&&Object(r.jsx)("img",{src:"/Web-3D-Viewer/error.png",alt:"o",width:"16px"}),Object(r.jsx)("span",{children:this.state.status.message})]})})]})},e.sideBar=o.a.createRef(),e.state={status:null,selectedObjects:[],visibleObjects:[]},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.scene=new M(this.mount),this.scene.addEventListener("selectionChanged",(function(t){return e.setObjectsSelected(t.selection)}));var t=new I;t.onError=this.onLoadError,t.onProgress=this.onLoadProgress,t.onLoad=this.addMeshToScene,this.meshLoader=t,window.addEventListener("resize",this.onWindowResize,!1)}}]),n}(o.a.Component);a.a.render(Object(r.jsxs)(o.a.StrictMode,{children:[Object(r.jsx)(u,{}),Object(r.jsx)("div",{id:"content",children:Object(r.jsx)(H,{})})]}),document.getElementById("root")),i()}},[[43,1,2]]]);
//# sourceMappingURL=main.40b0118e.chunk.js.map