(this.webpackJsonpcloud3d=this.webpackJsonpcloud3d||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var s=n(7),c=n(8),i=n.n(c),r=n(22),o=n.n(r),a=(n(35),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,47)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),s(e),c(e),i(e),r(e)}))}),l=n(44),d=n(45),u=(n(36),function(){return Object(s.jsx)("div",{children:Object(s.jsx)(l.a,{expand:"md",children:Object(s.jsx)(d.a,{children:"Cloud3D"})})})}),h=n(12),b=n(6),j=n(16),f=n(4),v=n(2),O=n(3),p=n(1),m=n(0),g={drc:0,ply:1,stl:2,gltf:3},y=11184810,w=n(28),x=n(46),C=(n(39),n(40),function(e){return Object(s.jsxs)("li",{className:"sceneListItem "+(e.selected?"selected":""),id:e.uuid,children:[Object(s.jsx)("div",{children:Object(s.jsx)("label",{children:Object(s.jsx)("input",{type:"checkbox",className:"visibiltyCheckbox",value:e.uuid,defaultChecked:e.visible,onChange:e.onVisibleChanged})})}),Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{children:e.name}),Object(s.jsx)("label",{className:"selectionLabel",children:Object(s.jsx)("input",{type:"button",className:"selectionInput",value:e.uuid,onClick:e.onSelectionChanged})})]})]})}),L=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).onSelectionChanged=function(t){e.props.onSelectionChanged&&e.props.onSelectionChanged([t.target.value])},e.onVisibleChanged=function(t){e.props.onVisibilityToggled&&e.props.onVisibilityToggled([t.target.value],t.target.checked)},e.onDeleteButtonClicked=function(){if(e.sceneList.current){var t,n=e.sceneList.current.getElementsByClassName("selected"),s=[],c=Object(h.a)(n);try{for(c.s();!(t=c.n()).done;){var i=t.value;s.push(i.id)}}catch(r){c.e(r)}finally{c.f()}e.props.onObjectsRemoved&&e.props.onObjectsRemoved(s)}},e.onUploadButtonClicked=function(){var t=document.createElement("input");t.type="file",t.onchange=e.props.onFileSelected,t.click()},e.render=function(){var e=this;return Object(s.jsxs)("div",{className:"sidebar",children:[Object(s.jsx)(x.a,{color:"primary",onClick:this.onUploadButtonClicked,children:"+"}),Object(s.jsx)(x.a,{color:"danger",onClick:this.onDeleteButtonClicked,children:"-"}),Object(s.jsxs)("ul",{ref:this.sceneList,className:"sceneList",children:[" ",Object.entries(this.props.sceneObjects).map((function(t){var n=Object(w.a)(t,2),c=n[0],i=n[1];return Object(s.jsx)(C,Object(j.a)({uuid:c,onSelectionChanged:e.onSelectionChanged,onVisibleChanged:e.onVisibleChanged},i),c)}))]})]})},e.sceneList=i.a.createRef(),e}return n}(i.a.Component),k=n(17),S=n.n(k),E=n(21),R=n(23),P=n(24),B=n(25),F=n(26),D=function(e){var t=e.substring(e.lastIndexOf(".")+1,e.length)||e;return g[t]},V=function(e){return new Promise((function(t,n){var s=new FileReader;s.onload=function(){return t(s.result)},s.onerror=n,s.readAsDataURL(e)}))},U=function(){this.loaders={};var e=new R.a;e.setDecoderConfig({type:"wasm"}),e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.4.1/"),e.preload(),this.loaders[g.drc]=e;var t=new P.a;this.loaders[g.ply]=t;var n=new B.a;this.loaders[g.stl]=n;var s=new F.a;s.setDRACOLoader(e),this.loaders[3]=s,this.onLoad=null,this.onProgress=null,this.onError=null};U.prototype.Load=function(e,t){var n=this;return new Promise((function(s,c){e.load(t,(function(e){return s(e)}),n.onProgress,c)}))},U.prototype.LoadURL=function(){var e=Object(E.a)(S.a.mark((function e(t,n){var s,c,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=D(n||t),!(c=this.loaders[s])){e.next=15;break}return e.prev=3,e.next=6,this.Load(c,t);case 6:(i=e.sent)&&this.onLoad(i,n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.onError(e.t0);case 13:e.next=16;break;case 15:this.onError&&this.onError("No loaders found for this file");case 16:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}(),U.prototype.LoadFile=function(){var e=Object(E.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}return e.prev=1,e.next=4,V(t);case 4:n=e.sent,this.LoadURL(n,t.name),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.onError(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();var N=U,z=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e,s){var c;return Object(p.a)(this,n),(c=t.call(this,e,s)).rotateSpeed=1.5,c.zoomSpeed=2,c.staticMoving=!0,c}return n}(n(27).a),I="selectionChanged",M=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(e){var s;Object(p.a)(this,n),(s=t.call(this)).onClick=function(e){e.preventDefault();var t=new m.nb,n=s.renderer.domElement.getBoundingClientRect();t.x=(e.clientX-n.left)/(n.right-n.left)*2-1,t.y=-(e.clientY-n.top)/(n.bottom-n.top)*2+1;var c=new m.cb;c.setFromCamera(t,s.camera);var i=c.intersectObjects(s.meshRoot.children),r=i.length>0?[i[i.length-1].object.uuid]:[];s.dispatchEvent({type:I,selection:r})},s.removeObjectsByUUID=function(e){var t,n=Object(h.a)(e);try{for(n.s();!(t=n.n()).done;){var c=t.value,i=s.scene.getObjectByProperty("uuid",c);i&&(i.geometry.dispose(),i.material.dispose(),s.meshRoot.remove(i))}}catch(r){n.e(r)}finally{n.f()}},s.setColorOfObjects=function(e,t){var n,c=Object(h.a)(e);try{for(c.s();!(n=c.n()).done;){var i=n.value,r=s.scene.getObjectByProperty("uuid",i);r&&r.material&&r.material.color.setHex(t)}}catch(o){c.e(o)}finally{c.f()}},s.setVisibilityOfObjects=function(e,t){var n,c=Object(h.a)(e);try{for(c.s();!(n=c.n()).done;){var i=n.value,r=s.scene.getObjectByProperty("uuid",i);r&&(r.visible=t)}}catch(o){c.e(o)}finally{c.f()}},s.animate=function(){requestAnimationFrame(s.animate),s.controls.update(),s.render()},s.renderer=new m.qb({alpha:!0}),s.renderer.setPixelRatio(window.devicePixelRatio),e.appendChild(s.renderer.domElement),s.camera=new m.U(75,window.innerWidth/window.innerHeight,.001,5e3),s.camera.position.set(0,0,5),s.controls=new z(s.camera,s.renderer.domElement);var c=new m.j(16777215,1);return c.position.set=s.camera.position,s.camera.add(c),s.meshRoot=new m.a(3355443),s.scene=new m.eb,s.scene.add(s.camera),s.scene.add(s.meshRoot),s.renderer.domElement.addEventListener("click",s.onClick,!1),s.resize(s.renderer.domElement.clientWidth,s.renderer.domElement.clientHeight),s.animate(),s}return Object(f.a)(n,[{key:"resize",value:function(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.controls.handleResize()}},{key:"render",value:function(){this.renderer.render(this.scene,this.camera)}}]),n}(m.l),T=(n(42),0),W=1,A=2,H=function e(t){Object(p.a)(this,e),this.selected=!1,this.visible=!0,this.name=t},J=function(e){Object(v.a)(n,e);var t=Object(O.a)(n);function n(){var e;return Object(p.a)(this,n),(e=t.call(this)).addMeshToScene=function(t,n){console.log(n+" loaded!");var s=new m.M({color:y,flatShading:!0}),c=new m.J(t,s);c.name=n,e.scene.meshRoot.add(c);var i=new H(n),r=c.uuid,o=Object(j.a)(Object(j.a)({},e.state.sceneObjects),{},Object(b.a)({},r,i));e.setState({sceneObjects:o,status:{type:T,message:"Loaded: "+n}})},e.onLoadError=function(t){console.log(t),e.setState({status:{type:A,message:"An error occurred..."}})},e.onLoadProgress=function(e){console.log(e.loaded/e.total*100+"% loaded")},e.onObjectsRemoved=function(t){e.scene.removeObjectsByUUID(t);var n,s=Object(j.a)({},e.state.sceneObjects),c=Object(h.a)(t);try{for(c.s();!(n=c.n()).done;){delete s[n.value]}}catch(i){c.e(i)}finally{c.f()}e.setState({sceneObjects:s})},e.setObjectsSelected=function(t){var n,s=e.state.sceneObjects,c=[],i=[],r=Object(h.a)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o in s&&!s[o].selected&&c.push(o)}}catch(a){r.e(a)}finally{r.f()}Object.keys(s).forEach((function(e){t.includes(e)?s[e].selected=!0:(s[e].selected&&i.push(e),s[e].selected=!1)})),e.setState({selectedObjects:s}),e.scene.setColorOfObjects(i,y),e.scene.setColorOfObjects(c,16774912)},e.setObjectsVisibility=function(t,n){var s=e.state.sceneObjects;Object.keys(s).forEach((function(e){s[e].visible=n})),e.setState({selectedObjects:s}),e.scene.setVisibilityOfObjects(t,n)},e.onWindowResize=function(){if(e.mount){var t=e.mount.clientWidth,n=e.mount.clientHeight;e.scene.resize(t,n)}},e.onFileSelectedForUpload=function(t){var n=t.target.files[0];e.meshLoader.LoadFile(n),e.setState({status:{type:W,message:"Loading..."}})},e.render=function(){var e,t=this;return Object(s.jsxs)("div",{className:"viewer",children:[Object(s.jsx)(L,{ref:this.sideBar,onFileSelected:this.onFileSelectedForUpload,onSelectionChanged:this.setObjectsSelected,onObjectsRemoved:this.onObjectsRemoved,onVisibilityToggled:this.setObjectsVisibility,sceneObjects:this.state.sceneObjects}),Object(s.jsx)("div",{className:"window-3d noselect",ref:function(e){t.mount=e},children:(null===(e=this.state.status)||void 0===e?void 0:e.message)&&Object(s.jsxs)("div",{className:"status",children:[this.state.status.type===W&&Object(s.jsx)("img",{src:"/Web-3D-Viewer/spinner.gif",alt:"o",width:"40px"}),this.state.status.type===A&&Object(s.jsx)("img",{src:"/Web-3D-Viewer/error.png",alt:"o",width:"16px"}),Object(s.jsx)("span",{children:this.state.status.message})]})})]})},e.sideBar=i.a.createRef(),e.state={status:null,sceneObjects:{}},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.scene=new M(this.mount),this.scene.addEventListener("selectionChanged",(function(t){return e.setObjectsSelected(t.selection)}));var t=new N;t.onError=this.onLoadError,t.onProgress=this.onLoadProgress,t.onLoad=this.addMeshToScene,this.meshLoader=t,window.addEventListener("resize",this.onWindowResize,!1)}}]),n}(i.a.Component);o.a.render(Object(s.jsxs)(i.a.StrictMode,{children:[Object(s.jsx)(u,{}),Object(s.jsx)("div",{id:"content",children:Object(s.jsx)(J,{})})]}),document.getElementById("root")),a()}},[[43,1,2]]]);
//# sourceMappingURL=main.acd68e4d.chunk.js.map